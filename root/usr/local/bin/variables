#!/usr/bin/with-contenv bash

fuse_mountpoint=${MERGED_DEST:-/mnt/data}
local_mountpoint=${MERGED_SOURCE:-/mnt/local}
[[ -n "${POOLING_FS:-}" ]] && rclone_mountpoint="$(dirname $fuse_mountpoint)/cloud" || rclone_mountpoint=${fuse_mountpoint}

rclone_mount_basic_opts="
--uid=${PUID:-911}
--gid=${PGID:-911}
--cache-dir=/cache
--use-mmap
--allow-other
--umask=002
--rc
--rc-no-auth
--rc-addr=:5574
"

mfs_basic_opts="uid=${PUID:-911},gid=${PGID:-911},umask=022,allow_other"
mfs_branches=${MFS_BRANCHES:-${local_mountpoint}=RW:${rclone_mountpoint}=NC}

ufs_basic_opts="uid=${PUID:-911},gid=${PGID:-911},umask=022,allow_other"
ufs_branches=${UFS_BRANCHES:-${local_mountpoint}=RW:${rclone_mountpoint}=RO}
